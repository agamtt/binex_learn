
import os
import pty
import subprocess
import select

binary_path = './basic_input'

master, slave = pty.openpty()
process = subprocess.Popen(binary_path, stdin=slave, stdout=slave, stderr=slave, universal_newlines=True)

fds = [master]

while True:
    # PTY의 출력을 읽어옴
    rlist, _, _ = select.select(fds, [], [])
    
    for fd in rlist:
        output = os.read(fd, 4096)
        if output:
            print(output, end='')

    # 사용자 입력을 PTY로 전송
    user_input = input()
    os.write(master, user_input + "\n")

    # 프로그램이 종료되면 반복 종료
    if process.poll() is not None:
        break

# PTY와 프로세스 정리
os.close(master)
os.close(slave)